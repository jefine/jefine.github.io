<!DOCTYPE html>
<html>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    
    <title>sql关系代数 - Jefine</title>
    <meta charset="utf-8">
    
    <meta name="title" content="sql关系代数 - Jefine">
    <meta name="description" content="">
    <meta property="og:image" content="/favicon.png">
    <meta property="og:image:width" content="200" />
    <meta property="og:image:height" content="200" />
    
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Source Serif Pro', 'Source Han Serif TC', 'Noto Serif CJK TC', 'Noto Serif TC', serif;
        }
    </style>
    <link rel="shortcut icon" href="/favicon.png">
    
    <link rel="stylesheet"
        href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/arduino-light.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/jquery.min.js"></script>
<link rel="alternate" href="/atom.xml" title="Jefine" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="header">
    <div class="blog-title">
        <a href="/" class="logo">Jefine</a>
    </div>
    <nav class="navbar">
        <ul class="menu">
            
            
            
            <li class="menu-item">
                
                <a href="/" class="menu-item-link">Home</a>
                
            </li>
            
            
            
            <li class="menu-item">
                
                <a href="/archives" class="menu-item-link">Archives</a>
                
            </li>
            
            
            
            <li class="menu-item">
                
                <a href="/about" class="menu-item-link">About</a>
                
            </li>
            
            
            
            <li class="menu-item">
                
                <a href="/atom.xml" class="menu-item-link">Rss</a>
                
            </li>
            
        </ul>
    </nav>
</header>
    <main class="main">
        <article class="post">
    <div class="post-title">
        <h1 class="title">sql关系代数</h2>
    </div>
    <div class="post-content">
        <p>关系代数 </p>
<h2 id="1-Motivation"><a href="#1-Motivation" class="headerlink" title="1  Motivation"></a>1  Motivation</h2><p>In the previous notes we talked about how SQL is a declarative  programming language. This means that you specify what you want, but you don’t have to specify how to do it. This is great from a user’s  perspective as it makes the queries much easier to write. As database  engineers, however, we often want a language that is more expressive.  When we study query optimization in a few weeks we’re going to want a  way to express the many diﬀerent valid plans a database can use to  execute a query. For this we will use <strong>Relational Algebra</strong>, a procedural programming language (meaning that the query speciﬁes exactly what operators to use and in what order).</p>
<h2 id="2-Relational-Algebra-Introduction"><a href="#2-Relational-Algebra-Introduction" class="headerlink" title="2  Relational Algebra Introduction"></a>2  Relational Algebra Introduction</h2><p>All of the operators in relational algebra take in a relation and output a diﬀerent relation. A basic query looks like this:</p>
<p>πnames(dogs)</p>
<p>The π operator picks only the columns that it wants to advance to the next operator (just like SQL <strong><code>SELECT</code></strong>) - more on this operator later. The operator takes the dogs relation in  as a parameter and returns a relation that only has the name column of  the dogs relation left. An important fact about relational algebra is  that the relations are sets of tuples, meaning that they cannot have  duplicates in them. If the dogs relation is initially:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scooby</td>
<td>10</td>
</tr>
<tr>
<td>Buster</td>
<td>15</td>
</tr>
<tr>
<td>Buster</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
<p>The query above would return:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scooby</td>
</tr>
<tr>
<td>Buster</td>
</tr>
</tbody>
</table>
</div>
<h2 id="3-Projection-π"><a href="#3-Projection-π" class="headerlink" title="3  Projection (π)"></a>3  Projection (π)</h2><p>We have already been introduced to the <strong>projection operator</strong> which selects only the columns speciﬁed. The columns are speciﬁed in  the subscript of the operator like almost all parameters to operators.  The projection operator is relational algebra’s version of the SQL  SELECT clause.</p>
<p>We now can express SQL queries involving just the SELECT and FROM clauses with relational algebra. For example the SQL query:</p>
<p><strong>SELECT</strong> name <strong>FROM</strong> dogs ;</p>
<p>Can be represented with the expression we introduced in section 2:</p>
<p>πnames(dogs)</p>
<p>Note that there is no operator equivalent to the FROM operator in  relational algebra because the starting tables are arguments to the  actual operators.</p>
<h2 id="4-Selection-σ"><a href="#4-Selection-σ" class="headerlink" title="4  Selection (σ)"></a>4  Selection (σ)</h2><p>The <strong>selection operator</strong> is used to ﬁlter rows based  on a certain condition. Don’t let the name confuse you - this operator  is equivalent to SQL’s WHERE clause, <strong>not</strong> its SELECT clause. Let’s try to express the following query in terms of relational algebra:</p>
<p><strong>SELECT</strong> name , age <strong>FROM</strong> dogs <strong>WHERE</strong> age = 12;</p>
<p>The equivalent relational algebra expression is:</p>
<p>σage=12(πname,age(dogs))</p>
<p>Another correct expression for that query is:</p>
<p>πname,age(σage=12(dogs))</p>
<p>This illustrates the beauty of relational algebra. There is only one  (reasonable) way to write SQL for what the query is trying to  accomplish, but we can come up with multiple diﬀerent expressions in  relational algebra that get the same result. In the ﬁrst expression we  select only the columns we want ﬁrst, and then we ﬁlter out the rows we  don’t want. In the second we ﬁlter the rows ﬁrst and then select the  columns. We will soon learn ways to evaluate which of these plans is  better!</p>
<p>The selection operator also supports compound predicates. The ∧ symbol corresponds to the AND keyword in SQL and the ∨ symbol corresponds to the OR keyword. For example,</p>
<p><strong>SELECT</strong> name , age <strong>FROM</strong> dogs <strong>WHERE</strong> age = 12 <strong>AND</strong> name = ‘Timmy ’ ;</p>
<p>is equivalent to</p>
<p>πname,age(σage=12∧name=′Timmy′(dogs))</p>
<h2 id="5-Union-∪"><a href="#5-Union-∪" class="headerlink" title="5  Union (∪)"></a>5  Union (∪)</h2><p>The ﬁrst way we will learn how to combine data from diﬀerent relations is with the <strong>union operator</strong>. Just like the UNION clause in SQL, we take all the rows from each tuple and combine them removing duplicates along the way. As an example, say  we have a dogs table:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scooby</td>
<td>10</td>
</tr>
<tr>
<td>Buster</td>
<td>15</td>
</tr>
<tr>
<td>Garﬁeld</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
<p>and a cats table that looks like this:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tom</td>
<td>8</td>
</tr>
<tr>
<td>Garﬁeld</td>
<td>10</td>
</tr>
</tbody>
</table>
</div>
<p>The expression:</p>
<p>πname(dogs)∪πname(cats)</p>
<p>would return</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scooby</td>
</tr>
<tr>
<td>Buster</td>
</tr>
<tr>
<td>Tom</td>
</tr>
<tr>
<td>Garﬁeld</td>
</tr>
</tbody>
</table>
</div>
<p>Note that Garﬁeld only shows up once because of the set rules.  Additionally, note that one rule for all of these set operators is that  they must operate on relations that have the same number of attributes,  and the attributes must have the same type. It would not be legal to  union a relation with two columns with a relation that has only one  column.</p>
<h2 id="6-Set-Diﬀerence-−"><a href="#6-Set-Diﬀerence-−" class="headerlink" title="6  Set Diﬀerence (−)"></a>6  Set Diﬀerence (−)</h2><p>Another set operator is the set diﬀerence operator. Set diﬀerence is  equivalent to the SQL clause EXCEPT. It returns every row in the ﬁrst  table except the rows that also show up in the second table. If you run:</p>
<p>πname(dogs)−πname(cats)</p>
<p>expression on the dogs and cats table introduced in the previous section you would get:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scooby</td>
</tr>
<tr>
<td>Buster</td>
</tr>
</tbody>
</table>
</div>
<p>Garﬁeld does not show up because he is in the cats table, and none of the cats’ names will show up because it is only possible for rows from  the ﬁrst relation to show up in the output.</p>
<h2 id="7-Intersection-∩"><a href="#7-Intersection-∩" class="headerlink" title="7  Intersection (∩)"></a>7  Intersection (∩)</h2><p>Intersection is just like the INTERSECT SQL operator in that it only  keeps rows that occur in both tables in the intersection. If you run:</p>
<p>πname(dogs)∩πname(cats)</p>
<p>on the tables introduced in section 5 you would get:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Garﬁeld</td>
</tr>
</tbody>
</table>
</div>
<p>Because Garﬁeld is the only name to occur in both tables.</p>
<h2 id="8-Joins-⋈"><a href="#8-Joins-⋈" class="headerlink" title="8  Joins (⋈)"></a>8  Joins (⋈)</h2><p>We haven’t yet discussed how to represent joins in relational algebra - let’s ﬁx that! To join two tables together, write the left table on  the left of the ⋈ operator, put the join condition in the subscript, and put the right  operator on the right side. To join together the cats table with the  dogs table on the name column, you would write:</p>
<p>cats⋈cats.name=dogs.namedogs</p>
<p>If you don’t specify the join condition, it becomes a natural join.  Recall from the SQL notes that a natural join joins together all columns from each table with the same name. Therefore, you could also write the same query as above like:</p>
<p>cats⋈dogs</p>
<p>Just like the selection operator σ, the join operator ⋈ also supports the compound predicate operators ∧ (AND) and ∨ (OR).</p>
<h2 id="9-Rename-ρ"><a href="#9-Rename-ρ" class="headerlink" title="9  Rename (ρ)"></a>9  Rename (ρ)</h2><p>The last operator we will discuss is the <strong>rename operator</strong> which essentially accomplishes the same thing as aliasing in SQL. If  you wanted to avoid having to include the table name for the rest of the expression like you would for the expressions in the join section, you  could instead write:</p>
<p>cats⋈name=dnameρname−&gt;dname(dogs)</p>
<p>This expression renames the dogs relation’s name column to dname  ﬁrst, so there is no conﬂict in column names. You can no longer use a  natural join anymore because the columns do not have the same name, but  you no longer need to specify which relation the column is coming from  if you want to include other operators.</p>
<h2 id="10-Practice-Questions"><a href="#10-Practice-Questions" class="headerlink" title="10  Practice Questions"></a>10  Practice Questions</h2><p>Given the following two relations: </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">teams</span><span class="hljs-params">(teamid, name)</span></span> <br><span class="hljs-function"><span class="hljs-title">players</span><span class="hljs-params">(playerid, name, teamid, position)</span></span><br></code></pre></td></tr></table></figure>
<p>Answer the following questions:</p>
<ol>
<li>Write an expression that ﬁnds the name and playerid of every player that plays the “center” position.</li>
<li>Write an expression that ﬁnds the name of every player that plays on the “Warriors”</li>
<li>Write an expression that ﬁnds the teamid of all teams that do not have any players.</li>
</ol>

    </div>
    <div class="post-meta">
        
    <span class="post-time">二〇二一年一月九日</span>
    </div>
</article>

<div class="prev_next">
    <nav id="prev_next">

<div class="prev">
    
</div>
<div class="next">
    
    <p>Older</p>
    <a href="/2021/01/01/2021/"><div class="article-nav-title">2021</div></a>
    
</div>

</nav>
</div>

<div class="post-comment">
    



</div>

    </main>

    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>

</html>